# Replica Setとは

MongoDBが備えるレプリケーション（データ集合の複製）や自動フェールオーバーの仕組み  

### Replica Setの構成要素

https://kinsta.com/jp/blog/mongodb-replica-set/  

|プライマリノード|セカンダリノード|アービター|
|-|-|-|
|書き込み操作の対象となるノード|プライマリノードからデータをコピーするノード|データを持たない、投票にのみ参加するノード|
|（1レプリカセットに対して）1つ|複数|0または1つ|


プライマリノード
レプリカセットとのトランザクションにおけるメインのアクセスポイント  
書き込み操作を受け付ける唯一の存在  

まずプライマリのoplog(操作ログ)をコピーする。  
次に、セカンダリのそれぞれのデータセット上で、ログ記録された変更を繰り返します。  


MongoDBクラスタとは別物
シャードを使用して多くのノードにデータを分散する  

- クラスターはワークロードを分散し、データのシャードを多数のサーバーに保存する  
- レプリカセットはデータセットを完全に複製  

MongoDBのシャードクラスタでは、この２つの機能を組み合わせてることができ  
セカンダリノードに全てのシャードを複製する。  



